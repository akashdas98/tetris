(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{6021:function(t,e,i){Promise.resolve().then(i.bind(i,505)),Promise.resolve().then(i.bind(i,6413)),Promise.resolve().then(i.t.bind(i,1560,23))},505:function(t,e,i){"use strict";i.d(e,{default:function(){return n}});var r=i(7437),s=i(2265),o=i(5027);let a=[{shapes:[[[1,1,1,1]],[[1],[1],[1],[1]]],color:"#00ffff"},{shapes:[[[1,1],[1,1]]],color:"#ffff00"},{shapes:[[[0,1,0],[1,1,1]],[[1,0],[1,1],[1,0]],[[1,1,1],[0,1,0]],[[0,1],[1,1],[0,1]]],color:"#ff00ff"},{shapes:[[[1,0,0],[1,1,1]],[[1,1],[1,0],[1,0]],[[1,1,1],[0,0,1]],[[0,1],[0,1],[1,1]]],color:"#ff7f00"},{shapes:[[[0,0,1],[1,1,1]],[[1,0],[1,0],[1,1]],[[1,1,1],[1,0,0]],[[1,1],[0,1],[0,1]]],color:"#0000ff"},{shapes:[[[0,1,1],[1,1,0]],[[1,0],[1,1],[0,1]]],color:"#00ff00"},{shapes:[[[1,1,0],[0,1,1]],[[0,1],[1,1],[1,0]]],color:"#ff0000"}];function n(){let t=(0,s.useRef)(null),e=(t,e)=>{let i=[];for(let r=0;r<t;r++)i.push(Array(e).fill(null));return i},i=(t,e,i,r)=>{let s=e.shape;for(let e=0;e<s.length;e++)for(let o=0;o<s[e].length;o++)if(s[e][o]&&(void 0===t[i+e]||void 0===t[i+e][r+o]||t[i+e][r+o]))return!1;return!0},n=(t,e,i,r,s)=>{let o=e.shape;for(let a=0;a<o.length;a++)for(let n=0;n<o[a].length;n++)o[a][n]&&(t[i+a][r+n]=s?e.color:null)},h=t=>{for(let e=t.length-1;e>0;e--){let i=Math.floor(Math.random()*(e+1));[t[e],t[i]]=[t[i],t[e]]}return t},l=(t,e,i,r,s)=>{let o=0;for(let a=Math.max(0,i-s);a<=Math.min(t.length-1,i+s);a++)for(let i=Math.max(0,r-s);i<=Math.min(t[0].length-1,r+s);i++)if(t[a][i]===e&&++o>2)return!0;return!1},c=(t,r)=>{let s=e(t,r);for(let e=0;e<t;e++)for(let t=0;t<r;t++)if(null===s[e][t]){let r=!1,o=Array.from(Array(a.length).keys());for(let c of o=h(o)){let o=a[c],d=Array.from(Array(o.shapes.length).keys());for(let a of d=h(d)){let h=o.shapes[a];if(i(s,{shape:h,color:o.color},e,t)&&!l(s,o.color,e,t,2)){n(s,{shape:h,color:o.color},e,t,!0),r=!0;break}}if(r)break}}return s},d=(t,e,i)=>{let r=t.getContext("2d");t.width=t.parentElement.clientWidth,t.height=t.parentElement.clientHeight;let s=i-1.5-1;for(let t=0;t<e.length;t++)for(let a=0;a<e[t].length;a++)e[t][a]&&(r.strokeStyle=(0,o.U)(e[t][a],.3,.3),r.lineWidth=1.5,r.strokeRect(a*i+.75,t*i+.75,s,s))},u=()=>{if(!t.current)return;let e=t.current,i=Math.ceil(e.parentElement.clientWidth/30),r=c(Math.ceil(e.parentElement.clientHeight/30),i);d(e,r,30)};return(0,s.useEffect)(()=>(u(),window.addEventListener("resize",u),()=>window.removeEventListener("resize",u)),[]),(0,r.jsx)("canvas",{ref:t,style:{display:"block",width:"100%",height:"100%",background:"#000000"}})}},6413:function(t,e,i){"use strict";i.d(e,{default:function(){return k}});var r=i(7437),s=i(2265),o=i(5027);class a{constructor(t,e=30){this.drawTile=(t,e,i)=>{this.ctx.fillStyle=i,this.ctx.strokeStyle=(0,o.U)(i,.7,.6),this.ctx.lineWidth=2,this.ctx.fillRect(t*this.scale,e*this.scale,this.scale,this.scale),this.ctx.strokeRect(t*this.scale,e*this.scale,this.scale,this.scale)},this.drawPiece=t=>{let{getPivot:e,getColor:i,getMatrix:r}=t,s=e(),o=i();r().forEach(t=>{this.drawTile(t[0]+s[0],t[1]+s[1],o)})},this.draw=()=>{this.clear();for(let t=0;t<20;t++)for(let e=0;e<10;e++){let i=this.matrix[t][e];1===i.value&&this.drawTile(e,t,i.color)}},this.getMatrix=()=>this.matrix,this.getCtx=()=>this.ctx,this.clear=()=>this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.clearLine=()=>{let t=[];for(let e=19;e>=0;e--)this.matrix[e].every(t=>1===t.value)&&t.push(e);for(let e=t.length-1;e>=0;e--){let i=t[e];for(let t=i;t>0;t--)this.matrix[t]=this.matrix[t-1];this.matrix[0]=Array.from({length:10},()=>({value:0,color:null}))}return t.length>0&&(this.draw(),this.totalLinesCleared+=t.length),t.length},this.maxHeightReached=()=>this.matrix[0].some(t=>1===t.value),this.addToStack=t=>{t.getMatrix().forEach(e=>{var i;let r=t.getPivot(),s=null===(i=this.matrix[e[1]+r[1]])||void 0===i?void 0:i[e[0]+r[0]];s&&(s.value=1,s.color=t.getColor())})},this.getTotalLinesCleared=()=>this.totalLinesCleared,this.canvas=t,this.ctx=t.getContext("2d"),this.ctx.imageSmoothingEnabled=!1,this.scale=e,this.canvas.height=20*this.scale,this.canvas.width=10*this.scale,this.totalLinesCleared=0,this.matrix=Array.from({length:20},()=>Array.from({length:10},()=>({value:0,color:null})))}}class n{getRotationMatrix(t){return 0===t?[[0,1],[-1,0]]:[[0,-1],[1,0]]}checkKick(t,e,i,r){let s=!0;for(let n=0;n<i.length;n++){var o,a;if(i[n][0]+this.pivot[0]+t<0||i[n][0]+this.pivot[0]+t>9||i[n][1]+this.pivot[1]+e<0||i[n][1]+this.pivot[1]+e>19||(null===(a=r[i[n][1]+this.pivot[1]+e])||void 0===a?void 0:null===(o=a[i[n][0]+this.pivot[0]+t])||void 0===o?void 0:o.value)===1){s=!1;break}}return s}doKick(t,e,i,r){this.pivot[0]+=t,this.pivot[1]+=e,this.changeOrientation(r)}changeOrientation(t){this.orientation=1===t?((this.orientation+1)%4+4)%4:((this.orientation-1)%4+4)%4}constructor({matrix:t,pivot:e,id:i,color:r}){this.setPivot=(t,e)=>{this.pivot=[t,e]},this.getPivot=()=>this.pivot,this.getMatrix=()=>this.matrix,this.getColor=()=>this.color,this.rotate=(t,e)=>{if("O"===this.id)return;let i=this.rotateMatrix(this.matrix,t);this.changeOrientation(t);let r=!1;for(let[s,o]of this.kickData[this.orientation])if(this.checkKick(s,o,i,e)){this.doKick(s,o,i,t),this.matrix=i,r=!0;break}r||this.changeOrientation(0===t?1:0)},this.rotateMatrix=(t,e)=>{let i=this.getRotationMatrix(e);return t.map(t=>[i[0][0]*t[0]+i[0][1]*t[1],i[1][0]*t[0]+i[1][1]*t[1]])},this.matrix=t,this.pivot=e,this.id=i,this.color=r,this.orientation=0,this.kickData=[[[0,0],[0,0],[0,0],[0,0],[0,0]],[[0,0],[1,0],[0,-1],[0,2],[1,2]],[[0,0],[0,0],[0,0],[0,0],[0,0]],[[0,0],[-1,0],[-1,-1],[0,2],[-1,2]]]}}class h extends n{constructor(t,e){super({id:"T",color:"#ff00ff",pivot:[t,e],matrix:[[0,-1],[-1,0],[0,0],[1,0]]})}}class l extends n{constructor(t,e){super({id:"I",color:"#00ffff",pivot:[t,e],matrix:[[-1.5,.5],[-.5,.5],[.5,.5],[1.5,.5]]}),this.kickData=[[[0,0],[-1,0],[2,0],[-1,0],[2,0]],[[-1,0],[0,0],[0,0],[0,1],[0,-2]],[[-1,1],[1,1],[-2,1],[1,0],[-2,0]],[[0,1],[0,1],[0,1],[0,-1],[0,2]]]}}class c extends n{constructor(t,e){super({id:"O",color:"#ffff00",pivot:[t,e],matrix:[[-1,0],[0,0],[-1,-1],[0,-1]]}),this.rotate=()=>{}}}class d extends n{constructor(t,e){super({id:"S",color:"#00ff00",pivot:[t,e],matrix:[[-1,0],[0,0],[0,-1],[1,-1]]})}}class u extends n{constructor(t,e){super({id:"J",color:"#0000ff",pivot:[t,e],matrix:[[-1,0],[0,0],[1,0],[-1,-1]]})}}class p extends n{constructor(t,e){super({id:"Z",color:"#ff0000",pivot:[t,e],matrix:[[-1,-1],[0,0],[0,-1],[1,0]]})}}class f extends n{constructor(t,e){super({id:"L",color:"#ff7f00",pivot:[t,e],matrix:[[-1,0],[0,0],[1,0],[1,-1]]})}}class v{constructor(t){this.updateDisplay=()=>{this.display.innerText=this.score.toString()},this.getScore=()=>this.score,this.addScore=(t,e)=>{this.score+=this.baseScoreMap[t]*(e+1),this.updateDisplay()},this.display=t,this.score=0,this.baseScoreMap={0:0,1:40,2:100,3:200,4:1200},this.updateDisplay()}}class m{constructor(t,e){this.updateDisplay=()=>{this.display.innerText=this.currentLevel.toString()},this.getCurrentLevel=()=>this.currentLevel,this.updateLevel=t=>{t>=this.linesForNextLevelUp&&(this.currentLevel++,this.linesForNextLevelUp+=10,this.updateDisplay())},this.getCurrentSpeed=()=>this.currentLevel>=29?this.levelSpeedList[29]:this.levelSpeedList[this.currentLevel],this.display=e,this.startingLevel=t,this.currentLevel=t,this.linesForNextLevelUp=Math.min(10*this.startingLevel+10,Math.max(100,10*this.startingLevel-50)),this.levelSpeedList=[800,717,633,550,467,383,300,217,133,100,83,83,83,67,67,67,50,50,50,33,33,33,33,33,33,33,33,33,33,17],this.updateDisplay()}}class g{constructor(t,e=0){this.history=99,this.handleKeyDown=t=>{let e=this.board.getMatrix();switch(t.key){case"ArrowLeft":this.tryMove(-1,0);break;case"ArrowRight":this.tryMove(1,0);break;case"ArrowDown":this.startSoftDrop();break;case"ArrowUp":case"c":this.currentPiece.rotate(1,e);break;case" ":this.currentPiece.rotate(0,e);break;default:return}this.redrawGameBoard()},this.handleKeyUp=t=>{"ArrowDown"===t.key&&this.stopSoftDrop()},this.tryMove=(t,e)=>{let i=this.currentPiece.getMatrix(),r=this.currentPiece.getPivot();i.every(i=>{let s=i[0]+r[0]+t,o=i[1]+r[1]+e;return this.isPositionValid(s,o)})&&this.currentPiece.setPivot(r[0]+t,r[1]+e)},this.isPositionValid=(t,e)=>{var i,r;let s=this.board.getMatrix();return t>=0&&t<=9&&e<=19&&(null===(r=s[e])||void 0===r?void 0:null===(i=r[t])||void 0===i?void 0:i.value)!==1},this.startSoftDrop=()=>{this.isSoftDropping||(this.updateCurrentSpeed(Math.min(100,this.level.getCurrentSpeed()/2)),this.isSoftDropping=!0)},this.stopSoftDrop=()=>{this.updateCurrentSpeed(this.level.getCurrentSpeed()),this.isSoftDropping=!1},this.canDrop=()=>{let t=this.board.getMatrix(),e=this.currentPiece.getMatrix(),i=this.currentPiece.getPivot();return e.every(e=>{var r,s;let o=e[1]+i[1]+1;return o<=19&&(null===(s=t[o])||void 0===s?void 0:null===(r=s[e[0]+i[0]])||void 0===r?void 0:r.value)!==1})},this.redrawGameBoard=()=>{this.board.draw(),this.board.drawPiece(this.currentPiece)},this.updateCurrentSpeed=t=>{this.currentSpeed=t},this.startGame=()=>{this.stopped=!1,console.log("STARTED"),this.spawn(),this.startDropLoop()},this.startDropLoop=()=>{this.frameRequestHandle=requestAnimationFrame(this.dropLoop)},this.dropLoop=t=>{let e=t-this.lastUpdateTime;for(this.lastUpdateTime=t,this.accumulatedTime+=e;this.accumulatedTime>this.currentSpeed;)this.canDrop()?this.drop():this.timeout||this.queueStop(),this.accumulatedTime-=this.currentSpeed;this.redrawGameBoard(),this.stopped||this.startDropLoop()},this.spawn=()=>{this.currentPiece=this.nextPiece,this.nextPiece=this.generateRandomPiece(),this.board.drawPiece(this.currentPiece)},this.drop=()=>{let t=this.currentPiece.getPivot();this.currentPiece.setPivot(t[0],t[1]+1),this.redrawGameBoard()},this.queueStop=()=>{this.timeout||(console.log("STOPPING"),this.timeout=setTimeout(this.stop,1e3))},this.stop=()=>{if(console.log("STOPPED"),this.clearStopTimeout(),this.canDrop()){console.log("STOP CANCELLED");return}this.clearDropInterval(),this.stopped=!0,this.handlePostOps(),this.board.maxHeightReached()?console.log("GAME OVER"):this.startGame()},this.handlePostOps=()=>{console.log("ADDING TO BOARD"),this.board.addToStack(this.currentPiece),console.log("CLEARING LINES");let t=this.board.clearLine();this.scoring.addScore(t,this.level.getCurrentLevel()),this.level.updateLevel(this.board.getTotalLinesCleared()),this.updateCurrentSpeed(this.level.getCurrentSpeed())},this.clearDropInterval=()=>{this.frameRequestHandle&&(cancelAnimationFrame(this.frameRequestHandle),this.frameRequestHandle=null)},this.clearStopTimeout=()=>{this.timeout&&clearTimeout(this.timeout),this.timeout=void 0},this.randomizer=()=>{let t=Math.floor(7*Math.random());for(;t===this.history;)t=Math.floor(7*Math.random());return this.history=t,t},this.generateRandomPiece=()=>{let t;switch(this.randomizer()){case 0:t=new h(5,0);break;case 1:t=new l(4.5,-.5);break;case 2:t=new u(5,0);break;case 3:t=new f(5,0);break;case 4:t=new d(5,0);break;case 5:t=new c(5,0);break;default:t=new p(5,0)}return t},this.lastUpdateTime=window.performance.now(),this.board=new a(t),this.scoring=new v(document.getElementById("score")),this.level=new m(e,document.getElementById("currentLevel")),this.currentSpeed=this.level.getCurrentSpeed(),this.nextPiece=this.generateRandomPiece(),this.currentPiece=this.generateRandomPiece(),this.isSoftDropping=!1,this.accumulatedTime=0,this.frameRequestHandle=null,this.stopped=!0,window.addEventListener("keydown",this.handleKeyDown),window.addEventListener("keyup",this.handleKeyUp)}}var x=i(8650),w=i.n(x);function k(){let t=(0,s.useRef)(null),e=(0,s.useRef)(null);return(0,s.useEffect)(()=>{if(!t.current&&e.current){let i=new g(e.current,6);i.startGame(),t.current=i}}),(0,r.jsxs)("div",{id:"gameComponent",children:[(0,r.jsx)("canvas",{style:{background:"#000000",display:"block"},ref:e}),(0,r.jsxs)("div",{id:w().details,children:[(0,r.jsxs)("p",{id:"scoring",children:[(0,r.jsx)("span",{children:"Score: "}),(0,r.jsx)("span",{id:"score"})]}),(0,r.jsxs)("p",{id:"level",children:[(0,r.jsx)("span",{children:"Level: "}),(0,r.jsx)("span",{id:"currentLevel"})]})]})]})}},5027:function(t,e,i){"use strict";i.d(e,{U:function(){return n}});let{min:r,max:s,round:o}=Math;function a(t,e,i){return(i<0&&(i+=1),i>1&&(i-=1),i<1/6)?t+(e-t)*6*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t}function n(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5,n=function(t){let e=t.startsWith("#")?t.slice(1):t;if(3===e.length&&(e=e.split("").map(t=>t+t).join("")),6!==e.length)return null;let i=parseInt(e,16);return{r:i>>16&255,g:i>>8&255,b:255&i}}(t);if(!n)throw Error("Invalid hex color");let{r:h,g:l,b:c}=n,{h:d,s:u,l:p}=function(t,e,i){let o=s(t/=255,e/=255,i/=255),a=r(t,e,i),n=0,h,l=(o+a)/2;if(o===a)return{h:0,s:0,l};let c=o-a;return h=l>.5?c/(2-o-a):c/(o+a),o===t&&(n=(e-i)/c+(e<i?6:0)),o===e&&(n=(i-t)/c+2),o===i&&(n=(t-e)/c+4),{h:n/=6,s:h,l}}(h,l,c),{r:f,g:v,b:m}=function(t,e,i){let r,s,n;if(0===e)r=s=n=i;else{let o=i<.5?i*(1+e):i+e-i*e,h=2*i-o;r=a(h,o,t+1/3),s=a(h,o,t),n=a(h,o,t-1/3)}return{r:o(255*r),g:o(255*s),b:o(255*n)}}(d,u*e,p*i);return"#".concat((16777216+(f<<16)+(v<<8)+m).toString(16).slice(1).toUpperCase())}},8650:function(t){t.exports={details:"gameComponent_details__bmvwq"}},1560:function(t){t.exports={App:"home_App__BywAG",backgroundContainer:"home_backgroundContainer__PGzuy",backgroundWrapper:"home_backgroundWrapper__1q6Gt",gameContainer:"home_gameContainer__jOv7f"}}},function(t){t.O(0,[734,971,23,744],function(){return t(t.s=6021)}),_N_E=t.O()}]);